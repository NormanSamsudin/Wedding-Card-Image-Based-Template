<!-- Splash Overlay for Initial Animation -->
<div class="splash-overlay" [class.splash-hidden]="splashHidden">
  <div class="splash-content">
    <img src="/akak/home_muazz_shafiqah_new.png" alt="Wedding Splash" class="splash-image" />
  </div>
</div>

<div class="landing-background-landing" [class.landing-visible]="splashHidden">
  <!-- Scrollable container with video background -->
  <div style="height: 100vh; overflow-y: auto; overflow-x: hidden; position: relative; width: 100%; scrollbar-width: none; -ms-overflow-style: none;" class="hide-scrollbar">
    <!-- Background Video Layer -->
    <video 
      #backgroundVideo
      muted 
      playsinline
      preload="auto"
      autoplay
      loop
      (loadeddata)="onVideoLoaded()"
      (error)="onVideoError($event)"
      (canplay)="onVideoCanPlay()"
      (timeupdate)="onVideoTimeUpdate($event)"
    >
      <source src="assets/muazzshafiqah.mp4" type="video/mp4">
    </video>
</div>
<!-- Bottom Navigation with RSVP button -->
<app-bottom-navigation (navigationClick)="onNavigationClick($event)" (musicToggle)="toggleMusic()"></app-bottom-navigation>

  <!-- Wishes Modal -->
  <div class="wishes-modal-overlay" *ngIf="wishesModalOpen" (click)="closeWishesModal()">
    <div class="wishes-modal" (click)="$event.stopPropagation()">
      <div *ngIf="isLoadingWishes" class="loading-wishes">
        <div class="spinner"></div>
      </div>
      <div *ngIf="!isLoadingWishes && wishes.length === 0" class="no-wishes">Tiada ucapan lagi.</div>
      <div *ngIf="!isLoadingWishes && wishes.length > 0" class="wishes-modal-carousel">
        <div class="wishes-carousel-container">
          <div *ngFor="let wish of wishes; let i = index" 
               class="wish-card-modal" 
               [class.active]="i === currentWishIndex">
            <div class="wish-main-simple">
              <div class="wish-message-simple">{{ wish.message }}</div>
              <div class="wish-author-simple">- {{ wish.name }} -</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- RSVP Modal -->
  <div class="rsvp-modal-overlay" *ngIf="rsvpModalOpen" (click)="closeRSVPModal()">
    <div class="rsvp-modal" (click)="$event.stopPropagation()">
      <form class="rsvp-form" (ngSubmit)="submitRSVP()" #rsvpFormRef="ngForm">
        <div class="rsvp-row">
          <div class="rsvp-input-group">
            <label for="name">Nama</label>
            <input type="text" id="name" [(ngModel)]="rsvpForm.name" name="name" required />
          </div>
          <div class="rsvp-input-group">
            <label for="jumlahRombongan">Bil. Peserta</label>
            <input type="number" id="jumlahRombongan" name="jumlahRombongan" min="1" max="20" [(ngModel)]="rsvpForm.jumlahRombongan"  required />
          </div>
        </div>
        
        <!-- Checkbox row -->
        <div class="rsvp-checkbox-group">
          <label class="rsvp-checkbox">
            <input type="checkbox" [(ngModel)]="rsvpForm.hadir" name="hadir" (change)="rsvpForm.hadir ? rsvpForm.tidakHadir = false : null" /> Hadir
          </label>
          <label class="rsvp-checkbox">
            <input type="checkbox" [(ngModel)]="rsvpForm.tidakHadir" name="tidakHadir" (change)="rsvpForm.tidakHadir ? rsvpForm.hadir = false : null" /> Tidak Hadir
          </label>
        </div>
        
        <!-- Full width message field -->
        <div class="rsvp-input-group full-width">
          <label for="message">Ucapan</label>
          <textarea id="message" name="message" [(ngModel)]="rsvpForm.message" rows="3" required></textarea>
        </div>
        <br />
        <button type="submit" class="rsvp-gradient-btn" [disabled]="rsvpService.loading$ | async">Hantar</button>
  
      </form>
      <!-- RSVP Error/Success Popup -->
      <div *ngIf="rsvpPopupMessage" class="rsvp-popup-message" [ngClass]="{'error': rsvpPopupType==='error', 'success': rsvpPopupType==='success'}">
        <div class="rsvp-popup-content">
          <span>{{ rsvpPopupMessage }}</span>
          <button class="rsvp-popup-close" (click)="closeRSVPPopup()">Tutup</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Location Modal -->
  <div class="location-modal-overlay" *ngIf="locationModalOpen" (click)="closeLocationModal()">
    <div class="location-modal" (click)="$event.stopPropagation()">
        <div style="width:100%; display:flex; flex-direction:column; ">
          <div style="width:100%; display:flex; justify-content:center;">
            <iframe
              width="98%"
              height="100"
              frameborder="0"
              style="border-radius:14px; border:0; box-shadow:0 2px 12px rgba(80,80,80,0.08);"
              src="https://www.google.com/maps?q=Dewan+Tun+Rahah+Yayasan+Tun+Razak,Malaysia&z=16&output=embed"
              allowfullscreen=""
              aria-hidden="false"
              tabindex="0"
            ></iframe>
          </div>
          <div style="width:100%; display:flex; justify-content:center; gap:8px; margin-top:18px;">
            <a href="https://www.google.com/maps/place/Dewan+Tun+Rahah+Yayasan+Tun+Razak/@3.1479049,101.7162644,842m/data=!3m2!1e3!4b1!4m6!3m5!1s0x31cc36324b413a75:0x6aed2bee089f3139!8m2!3d3.1478995!4d101.7188393!16s%2Fg%2F1hdz8gqll" target="_blank" class="location-gradient-btn" style="display:inline-flex;align-items:center;gap:8px;min-width:0;padding:10px 18px;text-decoration:none!important;">
              <img src="/akak/icon/google.png" alt="Google Maps" style="width:22px;height:22px;filter:brightness(0) invert(1);" /> Google Maps
            </a>
            <a href="https://waze.com/ul?q=Dewan%20Tun%20Rahah%20Yayasan%20Tun%20Razak&navigate=yes" target="_blank" class="location-gradient-btn" style="display:inline-flex;align-items:center;gap:8px;min-width:0;padding:10px 18px;text-decoration:none!important;">
              <img src="/akak/icon/waze.png" alt="Waze" style="width:22px;height:22px;filter:brightness(0) invert(1);" /> Waze
            </a>
          </div>
        </div>
    </div>
  </div>

  <!-- Contact Modal -->
  <div class="contact-modal-overlay" *ngIf="contactModalOpen" (click)="closeContactModal()">
    <div class="contact-modal" (click)="$event.stopPropagation()">
      <div class="contact-content">
        <div class="contact-item">
          <div class="contact-info">
            <span class="contact-name">Samsudin</span>
            <span class="contact-role">Father</span>
          </div>
          <div class="contact-actions">
            <a [href]="'https://wa.me/60142437636'" target="_blank" title="WhatsApp">
              <img src="akak/icon/whatsapp.png" alt="WhatsApp" class="contact-icon" />
            </a>
            <a [href]="'tel:0182402451'" title="Call">
              <img src="/akak/icon/phone.svg" alt="Call" class="contact-icon phone" />
            </a>
          </div>
        </div>
        <div class="contact-item">
          <div class="contact-info">
            <span class="contact-name">Fikry</span>
            <span class="contact-role">Brother</span>
          </div>
          <div class="contact-actions">
            <a [href]="'https://wa.me/60172536079'" target="_blank" title="WhatsApp">
              <img src="akak/icon/whatsapp.png" alt="WhatsApp" class="contact-icon" />
            </a>
            <a [href]="'tel:0182402451'" title="Call">
              <img src="/akak/icon/phone.svg" alt="Call" class="contact-icon phone" />
            </a>
          </div>
        </div>
        <div class="contact-item">
          <div class="contact-info">
            <span class="contact-name">Fahmi</span>
            <span class="contact-role">Brother</span>
          </div>
          <div class="contact-actions">
            <a [href]="'https://wa.me/6016234543345'" target="_blank" title="WhatsApp">
              <img src="akak/icon/whatsapp.png" alt="WhatsApp" class="contact-icon" />
            </a>
            <a [href]="'tel:0182402451'" title="Call">
              <img src="/akak/icon/phone.svg" alt="Call" class="contact-icon phone" />
            </a>
          </div>
        </div>
        <div class="contact-item">
          <div class="contact-info">
            <span class="contact-name">Norman</span>
            <span class="contact-role">Brother</span>
          </div>
          <div class="contact-actions">
            <a [href]="'https://wa.me/60182402451'" target="_blank" title="WhatsApp">
              <img src="akak/icon/whatsapp.png" alt="WhatsApp" class="contact-icon" />
            </a>
            <a [href]="'tel:0182402451'" title="Call">
              <img src="/akak/icon/phone.svg" alt="Call" class="contact-icon phone" />
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
